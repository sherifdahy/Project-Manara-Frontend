<ng-container *ngIf="(faculties$ | async) as faculties">
  <!-- Page Header -->
  <div class="page-header mb-4">
    <div>
      <h1 class="page-title mb-1">Faculties</h1>
      <p class="page-description mb-0">View and manage all university faculties</p>
    </div>
  </div>

  <!-- Stats Cards Row -->
  <div class="row g-3 mb-4">
    <!-- Total Faculties -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Faculties</span>
            <h3 class="stats-number">9563</h3>
            <span class="stats-meta text-success">523 active</span>
          </div>
          <div class="stats-icon-wrapper bg-primary-soft">
            <i class="fa-solid fa-building text-primary"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Total Students -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Students</span>
            <h3 class="stats-number">9563</h3>
            <span class="stats-meta">Across all faculties</span>
          </div>
          <div class="stats-icon-wrapper bg-success-soft">
            <i class="fa-solid fa-user-graduate text-success"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Total Staff -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Staff</span>
            <h3 class="stats-number">95163</h3>
            <span class="stats-meta">Faculty members</span>
          </div>
          <div class="stats-icon-wrapper bg-warning-soft">
            <i class="fa-solid fa-users text-warning"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Total Programs -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Programs</span>
            <h3 class="stats-number">515</h3>
            <span class="stats-meta">Academic programs</span>
          </div>
          <div class="stats-icon-wrapper bg-info-soft">
            <i class="fa-solid fa-book-open text-info"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- All Faculties Section -->
  <div class="faculties-section">
    <div class="section-card">
      <!-- Section Header -->
      <div class="section-header">
        <div>
          <h4 class="section-title">All Faculties</h4>
          <p class="section-subtitle">Manage and view faculty information</p>
        </div>

        <div class="d-flex gap-2">
          <!-- Search Bar -->
          <div class="search-bar-container">
            <div class="search-bar">
              <i class="fa-solid fa-search search-icon"></i>
              <input type="text" class="search-input" placeholder="Search faculties..." [(ngModel)]="searchTerm"
                (input)="onSearch()">
            </div>
          </div>

          <!-- Status Filter -->
          <div class="filter-dropdown-container">
            <div class="custom-select-wrapper">
              <select class="custom-select" [(ngModel)]="includeDisabled" (change)="onFilterChange()">
                <option [value]="false">Active Only</option>
                <option [value]="true">Include Disabled</option>
              </select>
              <i class="fa-solid fa-chevron-down select-icon"></i>
            </div>
          </div>
          <button class="btn-add-faculty" (click)="openFacultyFormDialog()">
            <i class="fa-solid fa-plus me-2"></i> Add Faculty
          </button>
        </div>
      </div>



      <!-- Faculties Table -->
      <div class="data-table-wrapper">
        <table class="data-table">
          <thead>
            <tr>
              <th>Faculty Name</th>
              <th>Dean</th>
              <th>Location</th>
              <th>Students</th>
              <th>Staff</th>
              <th>Departments</th>
              <th>Avg GPA</th>
              <th>Status</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let faculty of faculties">
              <td>
                <div class="table-cell-with-icon">
                  <div class="table-cell-icon">
                    <i class="fa-solid fa-building"></i>
                  </div>
                  <div class="table-cell-content">
                    <a [routerLink]="[faculty.id]" class="table-cell-title">{{ faculty.name }}</a>
                  </div>
                </div>
              </td>
              <td>Dr Sherif Dahy</td>
              <td>
                <span class="table-location-badge">
                  <i class="fa-solid fa-location-dot"></i> {{ faculty.address || 'N/A' }}
                </span>
              </td>
              <td>{{ faculty.numberOfStudents | number }}</td>
              <td>{{ faculty.numberOfStaff | number }}</td>
              <td>
                <div class="table-cell-multiline">
                  <span class="table-cell-primary">8542</span>
                  <span class="table-cell-secondary">9635 programs</span>
                </div>
              </td>
              <td><span class="table-value-badge">3.5</span></td>
              <td>
                <span class="table-status-badge" [ngClass]="{
                    'status-active': !faculty.isDeleted,
                    'status-inactive': faculty.isDeleted
                  }">
                  {{ faculty.isDeleted ? 'Disabled' : 'Active' }}
                </span>
              </td>
              <td>
                <div class="table-actions">
                  <a [routerLink]="[faculty.id]" class="table-action-btn btn-primary" title="Edit Faculty">
                    <i class="fa-solid fa-pen"></i>
                  </a>
                  <button class="table-action-btn" [ngClass]="{
                      'btn-success': faculty.isDeleted,
                      'btn-warning': !faculty.isDeleted
                    }" (click)="onToggleStatus(faculty.id)"
                    [title]="faculty.isDeleted ? 'Activate Faculty' : 'Disable Faculty'">
                    <i class="fa-solid" [ngClass]="{
                      'fa-check': faculty.isDeleted,
                      'fa-ban': !faculty.isDeleted
                    }"></i>
                  </button>
                </div>
              </td>
            </tr>

            <!-- Empty State -->
            <tr *ngIf="faculties.length === 0">
              <td colspan="9">
                <div class="table-empty-state">
                  <div class="table-empty-icon">
                    <i class="fa-solid fa-inbox"></i>
                  </div>
                  <h3 class="table-empty-title">No Faculties Found</h3>
                  <p class="table-empty-text">
                    {{ searchTerm ? 'No results match your search.' : 'There are no faculties to display at the moment.'
                    }}
                  </p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</ng-container>
