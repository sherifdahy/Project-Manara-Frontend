<!-- Page Header -->
<div class="page-header mb-4">
  <div>
    <h1 class="page-title mb-1">Departments</h1>
    <p class="page-description mb-0">
      View and manage all university departments
    </p>
  </div>
</div>

<!-- Stats Cards Row -->
<div class="row g-3 mb-4">
  <!-- Total Departments -->
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="stats-card">
      <div class="stats-header">
        <div class="stats-info">
          <span class="stats-label">Total Departments</span>
          <h3 class="stats-number">9563</h3>
          <span class="stats-meta text-success">523 active</span>
        </div>
        <div class="stats-icon-wrapper bg-primary-soft">
          <i class="fa-solid fa-building text-primary"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Total Students -->
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="stats-card">
      <div class="stats-header">
        <div class="stats-info">
          <span class="stats-label">Total Students</span>
          <h3 class="stats-number">9563</h3>
          <span class="stats-meta">Across all departments</span>
        </div>
        <div class="stats-icon-wrapper bg-success-soft">
          <i class="fa-solid fa-user-graduate text-success"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Total Staff -->
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="stats-card">
      <div class="stats-header">
        <div class="stats-info">
          <span class="stats-label">Total Staff</span>
          <h3 class="stats-number">95163</h3>
          <span class="stats-meta">Department members</span>
        </div>
        <div class="stats-icon-wrapper bg-warning-soft">
          <i class="fa-solid fa-users text-warning"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Total Programs -->
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="stats-card">
      <div class="stats-header">
        <div class="stats-info">
          <span class="stats-label">Total Programs</span>
          <h3 class="stats-number">515</h3>
          <span class="stats-meta">Academic programs</span>
        </div>
        <div class="stats-icon-wrapper bg-info-soft">
          <i class="fa-solid fa-book-open text-info"></i>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- All Departments Section -->
<div class="departments-section">
  <div class="section-card">
    <!-- Section Header -->
    <div class="section-header">
      <div>
        <h4 class="section-title">All Departments</h4>
        <p class="section-subtitle">Manage and view department information</p>
      </div>

      <div class="d-flex gap-2">
        <!-- Search Bar -->
        <div class="search-bar-container">
          <div class="search-bar">
            <i class="fa-solid fa-search search-icon"></i>
            <input
              type="text"
              class="search-input"
              placeholder="Search departments..."
            />
          </div>
        </div>

        <!-- Status Filter -->
        <div class="filter-dropdown-container">
          <div class="custom-select-wrapper">
            <select
              class="custom-select"
              [(ngModel)]="includeDisabled"
              (change)="onFilterChange()"
            >
              <option value="false">Active Only</option>
              <option value="true">Include Disabled</option>
            </select>
            <i class="fa-solid fa-chevron-down select-icon"></i>
          </div>
        </div>
        <button class="btn-add-department" (click)="openDepartmentFormDialog()">
          <i class="fa-solid fa-plus me-2"></i> Add Department
        </button>
      </div>
    </div>

    <!-- Departments Table -->
    <div class="data-table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th>Department Name</th>
            <th>Head Department</th>
            <th>Code</th>
            <th>Email</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngIf="departments$ | async as departments">
            <tr *ngFor="let department of departments">
              <td>
                <div class="table-cell-with-icon">
                  <div class="table-cell-icon">
                    <i class="fa-solid fa-building"></i>
                  </div>
                  <div class="table-cell-content">
                    <a href="#" class="table-cell-title">{{
                      department.name
                    }}</a>
                  </div>
                </div>
              </td>
              <td>{{ department.headOfDepartment }}</td>
              <td>{{ department.code }}</td>
              <td>{{ department.email }}</td>
              <td>
                <span
                  class="table-status-badge"
                  [ngClass]="{
                    'status-active': !department.isDeleted,
                    'status-inactive': department.isDeleted,
                  }"
                >
                  {{ department.isDeleted ? 'Disabled' : 'Active' }}
                </span>
              </td>
              <td>
                <div class="table-actions">
                  <a
                    [routerLink]="[department.id]"
                    class="table-action-btn btn-primary"
                    title="Edit Department"
                  >
                    <i class="fa-solid fa-pen"></i>
                  </a>
                  <button
                    class="table-action-btn"
                    [ngClass]="{
                      'btn-success': department.isDeleted,
                      'btn-warning': !department.isDeleted,
                    }"
                    (click)="onToggleStatus(department.id)"
                    [title]="
                      department.isDeleted
                        ? 'Activate Department'
                        : 'Disable Department'
                    "
                  >
                    <i
                      class="fa-solid"
                      [ngClass]="{
                        'fa-check': department.isDeleted,
                        'fa-ban': !department.isDeleted,
                      }"
                    ></i>
                  </button>
                </div>
              </td>
            </tr>

            <!-- Empty State -->
            <tr *ngIf="departments.length == 0">
              <td colspan="9">
                <div class="table-empty-state">
                  <div class="table-empty-icon">
                    <i class="fa-solid fa-inbox"></i>
                  </div>
                  <h3 class="table-empty-title">No Departments Found</h3>
                  <p class="table-empty-text">
                    There are no departments to display at the moment.
                  </p>
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>
