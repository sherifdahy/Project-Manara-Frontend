<ng-container *ngIf="(universities$ | async) as universities">
  <!-- Page Header -->
  <div class="page-header mb-4">
    <div>
      <h1 class="page-title mb-1">Universities</h1>
      <p class="page-description mb-0">View and manage all system universities</p>
    </div>
  </div>

  <!-- Stats Cards Row -->
  <div class="row g-3 mb-4">
    <!-- Total Universities -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Universities</span>
            <h3 class="stats-number">{{ universities.length }}</h3>
            <span class="stats-meta text-success">0 active</span>
          </div>
          <div class="stats-icon-wrapper bg-primary-soft">
            <i class="fa-solid fa-building-columns text-primary"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Total Students -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Students</span>
            <h3 class="stats-number">0</h3>
            <span class="stats-meta">Across all universities</span>
          </div>
          <div class="stats-icon-wrapper bg-success-soft">
            <i class="fa-solid fa-user-graduate text-success"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Total Faculties -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Faculties</span>
            <h3 class="stats-number">0</h3>
            <span class="stats-meta">Academic faculties</span>
          </div>
          <div class="stats-icon-wrapper bg-warning-soft">
            <i class="fa-solid fa-building text-warning"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Total Programs -->
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="stats-card">
        <div class="stats-header">
          <div class="stats-info">
            <span class="stats-label">Total Programs</span>
            <h3 class="stats-number">0</h3>
            <span class="stats-meta">Academic programs</span>
          </div>
          <div class="stats-icon-wrapper bg-info-soft">
            <i class="fa-solid fa-book-open text-info"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- All Universities Section -->
  <div class="universities-section">
    <div class="section-card">
      <!-- Section Header -->
      <div class="section-header">
        <div>
          <h4 class="section-title">All Universities</h4>
          <p class="section-subtitle">Manage and view university information</p>
        </div>
        <button class="btn-add-university" (click)="openUniversityForm()">
          <i class="fa-solid fa-plus me-2"></i> Add University
        </button>
      </div>

      <!-- Search and Filter Bar -->
      <div class="filters-wrapper mb-3">
        <!-- Search Bar -->
        <div class="search-bar-container">
          <div class="search-bar">
            <i class="fa-solid fa-search search-icon"></i>
            <input type="text" class="search-input" placeholder="Search universities..." [(ngModel)]="searchTerm"
              (input)="onSearch()">
          </div>
        </div>

        <!-- Status Filter -->
        <div class="filter-dropdown-container">
          <label class="filter-label">Status:</label>
          <div class="custom-select-wrapper">
            <select class="custom-select" [(ngModel)]="includeDisabled" (change)="onFilterChange()">
              <option [value]="false">Active Only</option>
              <option [value]="true">Include Disabled</option>
            </select>
            <i class="fa-solid fa-chevron-down select-icon"></i>
          </div>
        </div>
      </div>

      <!-- Universities Table -->
      <div class="data-table-wrapper">
        <table class="data-table">
          <thead>
            <tr>
              <th>University Name</th>
              <th>Location</th>
              <th>Established</th>
              <th>Students</th>
              <th>Faculties</th>
              <th>Status</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let university of universities">
              <td>
                <div class="table-cell-with-icon">
                  <div class="table-cell-icon">
                    <i class="fa-solid fa-building-columns"></i>
                  </div>
                  <div class="table-cell-content">
                    <a [routerLink]="[university.id]" class="table-cell-title">{{ university.name }}</a>
                  </div>
                </div>
              </td>
              <td>
                <span class="table-location-badge">
                  <i class="fa-solid fa-location-dot"></i> {{ university.address || 'N/A' }}
                </span>
              </td>
              <td>
                <div class="table-cell-multiline">
                  <span class="table-cell-primary">{{ 'N/A' }}</span>
                  <span class="table-cell-secondary">
                    69 years old
                  </span>
                </div>
              </td>
              <td>
                <span class="table-value-badge">69</span>
              </td>
              <td>
                <div class="table-cell-multiline">
                  <span class="table-cell-primary">51</span>
                  <span class="table-cell-secondary">365</span>
                </div>
              </td>
              <td>
                <span class="table-status-badge" [ngClass]="{
                  'status-active': !university.isDeleted,
                  'status-inactive': university.isDeleted
                }">
                  {{ university.isDeleted ? 'Disabled' : 'Active' }}
                </span>
              </td>
              <td>
                <div class="table-actions">
                  <button [routerLink]="[university.id]" class="table-action-btn btn-primary" title="Edit University">
                    <i class="fa-solid fa-pen"></i>
                  </button>
                  <button class="table-action-btn" [ngClass]="{
                      'btn-success': university.isDeleted,
                      'btn-warning': !university.isDeleted
                    }" (click)="onToggleStatus(university.id)"
                    [title]="university.isDeleted ? 'Activate University' : 'Disable University'">
                    <i class="fa-solid" [ngClass]="{
                      'fa-check': university.isDeleted,
                      'fa-ban': !university.isDeleted
                    }"></i>
                  </button>
                </div>
              </td>
            </tr>

            <!-- Empty State -->
            <tr *ngIf="universities.length === 0">
              <td colspan="7">
                <div class="table-empty-state">
                  <div class="table-empty-icon">
                    <i class="fa-solid fa-inbox"></i>
                  </div>
                  <h3 class="table-empty-title">No Universities Found</h3>
                  <p class="table-empty-text">
                    {{ searchTerm ? 'No results match your search.' : 'There are no universities to display at the
                    moment.' }}
                  </p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</ng-container>
